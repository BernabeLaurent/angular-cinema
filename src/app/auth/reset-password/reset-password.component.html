<div class="auth-container">
  <mat-card class="auth-card">
    <div class="dialog-header">
      <mat-card-title>Réinitialiser le mot de passe</mat-card-title>
    </div>

    <mat-card-content>
      <div *ngIf="!message && !error">
        <p class="description">
          Saisissez votre nouveau mot de passe.
        </p>

        <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Nouveau mot de passe</mat-label>
            <input
              matInput
              formControlName="newPassword"
              type="password"
              required
              autocomplete="new-password"
              aria-describedby="password-hint"
            />
            <mat-hint id="password-hint">Minimum 6 caractères</mat-hint>
            <mat-error *ngIf="resetPasswordForm.get('newPassword')?.hasError('required')">
              Le mot de passe est obligatoire
            </mat-error>
            <mat-error *ngIf="resetPasswordForm.get('newPassword')?.hasError('minlength')">
              Le mot de passe doit contenir au moins 6 caractères
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Confirmer le mot de passe</mat-label>
            <input
              matInput
              formControlName="confirmPassword"
              type="password"
              required
              autocomplete="new-password"
              aria-describedby="confirm-password-hint"
            />
            <mat-hint id="confirm-password-hint">Répétez votre nouveau mot de passe</mat-hint>
            <mat-error *ngIf="resetPasswordForm.get('confirmPassword')?.hasError('required')">
              La confirmation du mot de passe est obligatoire
            </mat-error>
            <mat-error *ngIf="resetPasswordForm.get('confirmPassword')?.hasError('passwordMismatch')">
              Les mots de passe ne correspondent pas
            </mat-error>
          </mat-form-field>

          <div class="button-group">
            <button
              mat-raised-button
              color="primary"
              class="full-width"
              type="submit"
              [disabled]="resetPasswordForm.invalid || isSubmitting"
            >
              {{ isSubmitting ? 'Réinitialisation...' : 'Réinitialiser le mot de passe' }}
            </button>

            <button
              mat-button
              type="button"
              class="full-width secondary-button"
              (click)="goBackToLogin()"
            >
              Retour à la connexion
            </button>
          </div>
        </form>
      </div>

      <div *ngIf="message" class="success-message">
        <mat-icon class="success-icon">check_circle</mat-icon>
        <p>{{ message }}</p>
        <p class="redirect-info">Redirection automatique vers la page de connexion...</p>
      </div>

      <div *ngIf="error && !message" class="error-message">
        <mat-icon class="error-icon">error</mat-icon>
        <p>{{ error }}</p>
        <button
          mat-raised-button
          color="primary"
          (click)="goBackToLogin()"
        >
          Retour à la connexion
        </button>
      </div>
    </mat-card-content>
  </mat-card>
</div>